<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Sinhala:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:'Noto Serif Sinhala',serif}
.gradient-bg{
  background:#EBF9DE;
  min-height:100vh
}
.result-word{color:#827717;font-weight:700}
.result-meaning{color:#827717}
.selected-result{background-color:#F9FBE7;border-left:4px solid #AFB42B}
.table-badge{
  display:inline-block;
  padding:2px 8px;
  border-radius:4px;
  font-size:.75rem;
  font-weight:600;
  margin-left:8px
}
body.dark-mode{
  background:linear-gradient(135deg,#1a202c 0%,#2d3748 100%)
}
body.dark-mode .gradient-bg{
  background:#EBF9DE
}
body.dark-mode .bg-white{
  background-color:#2d3748;
  color:#e2e8f0
}
body.dark-mode input{
  background-color:#4a5568;
  color:#e2e8f0;
  border-color:#4a5568
}
body.dark-mode .text-gray-800{color:#e2e8f0!important}
body.dark-mode .text-gray-700{color:#cbd5e0!important}
body.dark-mode .text-gray-600{color:#a0aec0!important}
body.dark-mode .hover\:bg-gray-50:hover{background-color:#374151!important}
body.dark-mode .bg-gray-50{background-color:#374151}
body.dark-mode .bg-gray-100{background-color:#1f2937}
body.dark-mode .border-gray-200{border-color:#4a5568}
.favorite-btn{
  cursor:pointer;
  transition:transform .2s
}
.favorite-btn:hover{transform:scale(1.2)}
.favorite-btn.active{color:#ef4444}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(-10px)}
  to{opacity:1;transform:translateY(0)}
}
.notification{animation:fadeIn .3s ease-out}
</style>
</head>
<body>
<div id="root"></div>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel">
const {useState,useEffect,useRef}=React;
const SB_URL='https://uqgzlaxsnknheoerbfus.supabase.co';
const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVxZ3psYXhzbmtuaGVvZXJiZnVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5MjM2MTUsImV4cCI6MjA3OTI4MzYxNX0.IYWZ7ukx8J-GJMWy7cMk2BWnmzJmJjjE93yEmJie7nQ';

const WORD_TYPES = [
  {label: '‡∂±‡∑è‡∂∏ ‡∂¥‡∂Ø', search: '(‡∂±‡∑è‡∂∏ ‡∂¥‡∂Ø‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∂¥‡∂Ø', search: '(‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∂¥‡∂Ø‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´', search: '(‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´ ‡∂¥‡∂Ø‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´ ‡∂¥‡∂Ø', search: '(‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´ ‡∂¥‡∂Ø‡∂∫‡∂ö‡∑í)'},
  {label: '‡∂ö‡∂≠‡∑è ‡∑Ä‡∑ä‚Äç‡∂∫‡∑Ä‡∑Ñ‡∑è‡∂ª‡∂∫‡∑ö ‡∂¥‡∑Ä‡∂≠‡∑í‡∂± ‡∑Ä‡∂†‡∂±', search: '(‡∂ö‡∂≠‡∑è ‡∑Ä‡∑ä‚Äç‡∂∫‡∑Ä‡∑Ñ‡∑è‡∂ª‡∂∫‡∑ö ‡∂¥‡∑Ä‡∂≠‡∑í‡∂± ‡∑Ä‡∂†‡∂±‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∑Ä‡∑í‡∑Ç‡∂∫‡∑è‡∂±‡∑î‡∂∂‡∂Ø‡∑ä‡∂∞ ‡∂¥‡∑è‡∂ª‡∑í‡∂∑‡∑è‡∑Ç‡∑í‡∂ö', search: '(‡∑Ä‡∑í‡∑Ç‡∂∫‡∑è‡∂±‡∑î‡∂∂‡∂Ø‡∑ä‡∂∞ ‡∂¥‡∑è‡∂ª‡∑í‡∂∑‡∑è‡∑Ç‡∑í‡∂ö‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∂±‡∑è‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∂ö‡∑ò‡∂≠‡∑í', search: '(‡∂±‡∑è‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∂ö‡∑ò‡∂≠‡∑í‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∂∂‡∑Ñ‡∑î‡∑Ä‡∂†‡∂± ‡∂±‡∑è‡∂∏ ‡∂¥‡∂Ø', search: '(‡∂∂‡∑Ñ‡∑î‡∑Ä‡∂†‡∂± ‡∂±‡∑è‡∂∏ ‡∂¥‡∂Ø‡∂∫‡∂ö‡∑í.)'},
  {label: '‡∂ª‡∑ñ‡∂™‡∑í', search: '(‡∂ª‡∑ñ‡∂™‡∑í.)'},
  {label: '‡∂ö‡∂∏‡∂≠‡∑ä ‡∂∂‡∑É', search: '(‡∂ö‡∂∏‡∂≠‡∑ä ‡∂∂‡∑É‡∑ô‡∑Ñ‡∑í ‡∑Ñ‡∂∏‡∑î ‡∑Ä‡∑ö)'},
  {label: '‡∂∞‡∑ì‡∑Ä‡∂ª ‡∂∂‡∑É', search: '(‡∂∞‡∑ì‡∑Ä‡∂ª ‡∂∂‡∑É‡∑ô‡∑Ñ‡∑í ‡∑Ñ‡∂∏‡∑î ‡∑Ä‡∑ö)'},
  {label: '‡∂¢‡∂±‡∑Ä‡∑Ñ‡∂ª', search: '(‡∂¢‡∂±‡∑Ä‡∑Ñ‡∂ª)'},
  {label: '‡∂Ø‡∑ö‡∑Ä ‡∂¥‡∑ñ‡∂¢‡∑è', search: '(‡∂Ø‡∑ö‡∑Ä ‡∂¥‡∑ñ‡∂¢‡∑è)'},
  {label: '‡∂≠‡∑ú‡∑Ä‡∑í‡∂Ω‡∑ä', search: '(‡∂≠‡∑ú‡∑Ä‡∑í‡∂Ω‡∑ä)'},
  {label: '‡∂±‡∑í‡∂¥‡∑è‡∂≠ ‡∂¥‡∂Ø', search: '(‡∂±‡∑í‡∂¥‡∑è‡∂≠.)'}
];

const TBL_COLORS={
  'sinhala_words':{bg:'bg-yellow-100',text:'text-yellow-900',label:'‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫'},
  'learnX pedia':{bg:'bg-lime-100',text:'text-lime-900',label:'LearnX'},
  'helavisithuru':{bg:'bg-green-100',text:'text-green-900',label:'‡∑Ñ‡∑ô‡∑Ö ‡∑Ä‡∑í‡∑É‡∑í‡∂≠‡∑î‡∂ª‡∑î'},
  'Historynt':{bg:'bg-amber-100',text:'text-amber-900',label:'‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫'},
  'english_dictionary':{bg:'bg-teal-100',text:'text-teal-900',label:'English'},
  'classic_l':{bg:'bg-lime-200',text:'text-lime-900',label:'‡∑É‡∂∏‡∑ä‡∂∑‡∑è‡∑Ä‡∑ä‚Äç‡∂∫'}
};

const TBL_COLS={
  'sinhala_words':{word:'word',meaning:'meaning'},
  'learnX pedia':{word:'word',meaning:'meaning'},
  'helavisithuru':{word:'word',meaning:'meaning'},
  'Historynt':{word:'title',meaning:'content'},
  'english_dictionary':{word:'word',meaning:'meaning'},
  'classic_l':{word:'book',meaning:'content'}
};

const SearchIcon=()=><svg className="w-6 h-6"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>;
const ChevronDownIcon=()=><svg className="w-5 h-5"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M19 9l-7 7-7-7"/></svg>;
const HeartIcon=({filled})=><svg className="w-6 h-6"fill={filled?"currentColor":"none"}stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>;
const MoonIcon=()=><svg className="w-6 h-6"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>;
const SunIcon=()=><svg className="w-6 h-6"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>;

const TableBadge=({source})=>{
  const c=TBL_COLORS[source]||{bg:'bg-gray-100',text:'text-gray-800',label:source};
  return<span className={`table-badge ${c.bg} ${c.text}`}>{c.label}</span>
};

const getGraphemeCount=(str)=>{
  if(!str)return 0;
  try{
    const segmenter=new Intl.Segmenter('si',{granularity:'grapheme'});
    return[...segmenter.segment(str)].length
  }catch(e){
    return str.length
  }
};

const isSinhala=(str)=>{
  if(!str)return false;
  const sinhalaRange=/[\u0D80-\u0DFF]/;
  return sinhalaRange.test(str)
};

function App(){
const[s1Term,setS1Term]=useState('');
const[s1Results,setS1Results]=useState([]);
const[s1Loading,setS1Loading]=useState(false);
const[selectedIdx,setSelectedIdx]=useState(-1);
const[selType,setSelType]=useState('');
const[s2Results,setS2Results]=useState([]);
const[s2Loading,setS2Loading]=useState(false);
const[showDD,setShowDD]=useState(false);
const[s3Term,setS3Term]=useState('');
const[s3Results,setS3Results]=useState([]);
const[s3Loading,setS3Loading]=useState(false);
const[letterPos,setLetterPos]=useState('1');
const[letterSrch,setLetterSrch]=useState('');
const[s4Results,setS4Results]=useState([]);
const[s4Loading,setS4Loading]=useState(false);
const[showPosDD,setShowPosDD]=useState(false);
const[letterCnt,setLetterCnt]=useState('');
const[s5Results,setS5Results]=useState([]);
const[s5Loading,setS5Loading]=useState(false);
const[modalOpen,setModalOpen]=useState(false);
const[modalContent,setModalContent]=useState({title:'',content:''});
const[favs,setFavs]=useState([]);
const[showFavs,setShowFavs]=useState(false);
const[darkMode,setDarkMode]=useState(false);
const[wod,setWod]=useState(null);
const[notif,setNotif]=useState('');
const[wCounts,setWCounts]=useState({
  'sinhala_words':0,
  'learnX pedia':0,
  'helavisithuru':0,
  'Historynt':0,
  'english_dictionary':0,
  'classic_l':0
});

const ddRef=useRef(null);
const resRef=useRef(null);
const posDDRef=useRef(null);

useEffect(()=>{
  try{
    const sf=localStorage.getItem('sinhala-favorites');
    if(sf)setFavs(JSON.parse(sf))
  }catch(e){}
  try{
    const sdm=localStorage.getItem('sinhala-darkMode');
    if(sdm){
      const isDark=JSON.parse(sdm);
      setDarkMode(isDark);
      if(isDark)document.body.classList.add('dark-mode')
    }
  }catch(e){}
  loadWOD();
  loadCounts()
},[]);

const loadCounts=async()=>{
  const tbls=['sinhala_words','learnX pedia','helavisithuru','Historynt','english_dictionary','classic_l'];
  const cnts={};
  for(const t of tbls){
    try{
      const r=await fetch(`${SB_URL}/rest/v1/${encodeURIComponent(t)}?select=id&limit=1`,{
        method:'HEAD',
        headers:{
          'apikey':SB_KEY,
          'Authorization':`Bearer ${SB_KEY}`,
          'Prefer':'count=exact'
        }
      });
      const cr=r.headers.get('content-range');
      if(cr){
        const m=cr.match(/\/(\d+)$/);
        if(m)cnts[t]=parseInt(m[1])
      }
    }catch(e){
      cnts[t]=0
    }
  }
  setWCounts(cnts)
};

const loadWOD=()=>{
  try{
    const today=new Date().toISOString().split('T')[0];
    const sw=localStorage.getItem('sinhala-wordOfDay');
    if(sw){
      const w=JSON.parse(sw);
      if(w.date===today){
        setWod(w.word);
        return
      }
    }
    const ro=Math.floor(Math.random()*1000);
    fetch(`${SB_URL}/rest/v1/sinhala_words?select=id,word,meaning&limit=1&offset=${ro}`,{
      headers:{
        'apikey':SB_KEY,
        'Authorization':`Bearer ${SB_KEY}`
      }
    })
    .then(r=>r.json())
    .then(d=>{
      if(d.length>0){
        const nw={...d[0],source:'sinhala_words',date:today};
        setWod(nw);
        localStorage.setItem('sinhala-wordOfDay',JSON.stringify(nw))
      }
    })
    .catch(e=>{})
  }catch(e){}
};

const toggleFav=item=>{
  const ik=`${item.source}-${item.id}`;
  let nf;
  if(favs.some(f=>`${f.source}-${f.id}`===ik)){
    nf=favs.filter(f=>`${f.source}-${f.id}`!==ik);
    showNotif('‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏‡∂∫‡∂±‡∑ä‡∂ú‡∑ô‡∂±‡∑ä ‡∂â‡∑Ä‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì')
  }else{
    nf=[...favs,item];
    showNotif('‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏‡∂∫‡∂±‡∑ä‡∂ß ‡∂ë‡∂ö‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì ‚≠ê')
  }
  setFavs(nf);
  localStorage.setItem('sinhala-favorites',JSON.stringify(nf))
};

const isFav=item=>favs.some(f=>`${f.source}-${f.id}`===`${item.source}-${item.id}`);

const toggleDark=()=>{
  const nm=!darkMode;
  setDarkMode(nm);
  document.body.classList.toggle('dark-mode');
  localStorage.setItem('sinhala-darkMode',JSON.stringify(nm));
  showNotif(nm?'üåô ‡∂Ö‡∂≥‡∑î‡∂ª‡∑î ‡∂Ü‡∂ö‡∑è‡∂ª‡∂∫ ‡∑É‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂∫‡∂∫‡∑í':'‚òÄÔ∏è ‡∂Ø‡∑ì‡∂¥‡∑ä‡∂≠ ‡∂Ü‡∂ö‡∑è‡∂ª‡∂∫ ‡∑É‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂∫‡∂∫‡∑í')
};

const showNotif=m=>{
  setNotif(m);
  setTimeout(()=>setNotif(''),3000)
};

const srchTbl=async(tbl,term,type='word')=>{
  try{
    const c=TBL_COLS[tbl];
    if(!c)return[];
    
    let url;
    if(type==='word'){
      url=`${SB_URL}/rest/v1/${encodeURIComponent(tbl)}?select=id,${c.word},${c.meaning}&${c.word}=ilike.*${encodeURIComponent(term)}*&limit=200&order=${c.word}.asc`
    }else{
      url=`${SB_URL}/rest/v1/${encodeURIComponent(tbl)}?select=id,${c.word},${c.meaning}&or=(${c.word}.ilike.*${encodeURIComponent(term)}*,${c.meaning}.ilike.*${encodeURIComponent(term)}*)&limit=200&order=${c.word}.asc`
    }
    
    const r=await fetch(url,{
      headers:{
        'apikey':SB_KEY,
        'Authorization':`Bearer ${SB_KEY}`
      }
    });
    
    if(r.ok){
      const d=await r.json();
      const res=[];
      const sl=term.toLowerCase();
      
      d.forEach(i=>{
        const wv=i[c.word];
        const mv=i[c.meaning];
        if(!wv||!mv)return;
        
        if(wv.includes(',')){
          const ws=wv.split(',').map(w=>w.trim());
          const mw=ws.filter(w=>w.toLowerCase().startsWith(sl));
          if(mw.length>0){
            res.push({id:i.id,word:wv,meaning:mv,source:tbl,matchedWords:mw})
          }
        }else{
          let si=false;
          if(type==='word'){
            if(wv.toLowerCase().startsWith(sl))si=true
          }else{
            si=true
          }
          if(si)res.push({id:i.id,word:wv,meaning:mv,source:tbl})
        }
      });
      return res
    }
    return[]
  }catch(e){
    return[]
  }
};

const doS1=async t=>{
  if(t.length<2){
    setS1Results([]);
    setSelectedIdx(-1);
    return
  }
  setS1Loading(true);
  try{
    const[r1,r2]=await Promise.all([
      srchTbl('sinhala_words',t,'word'),
      srchTbl('learnX pedia',t,'word')
    ]);
    const all=[...r1,...r2];
    all.sort((a,b)=>a.word.localeCompare(b.word,'si'));
    setS1Results(all);
    
    const emi=all.findIndex(i=>i.word.toLowerCase()===t.toLowerCase());
    if(emi!==-1)setSelectedIdx(emi);
    else if(all.length>0)setSelectedIdx(0)
  }catch(e){}
  finally{setS1Loading(false)}
};

const doS2=async ts=>{
  if(!ts)return;
  setS2Loading(true);
  try{
    const r=await fetch(`${SB_URL}/rest/v1/sinhala_words?select=id,word,meaning&meaning=ilike.*${encodeURIComponent(ts)}*&limit=100&order=word.asc`,{
      headers:{
        'apikey':SB_KEY,
        'Authorization':`Bearer ${SB_KEY}`
      }
    });
    if(r.ok){
      const d=await r.json();
      setS2Results(d.map(i=>({...i,source:'sinhala_words'})))
    }
  }catch(e){}
  finally{setS2Loading(false)}
};

const doS3=async t=>{
  if(t.length<2){
    setS3Results([]);
    return
  }
  setS3Loading(true);
  try{
    const[r1,r2,r3,r4,r5,r6]=await Promise.all([
      srchTbl('sinhala_words',t,'any'),
      srchTbl('learnX pedia',t,'any'),
      srchTbl('helavisithuru',t,'any'),
      srchTbl('Historynt',t,'any'),
      srchTbl('english_dictionary',t,'any'),
      srchTbl('classic_l',t,'any')
    ]);
    const all=[...r1,...r2,...r3,...r4,...r5,...r6];
    all.sort((a,b)=>a.word.localeCompare(b.word,'si'));
    setS3Results(all)
  }catch(e){}
  finally{setS3Loading(false)}
};

const srchByPos=async(tbl,ltr,pos)=>{
  try{
    const c=TBL_COLS[tbl];
    if(!c)return[];
    
    const r=await fetch(`${SB_URL}/rest/v1/${encodeURIComponent(tbl)}?select=id,${c.word},${c.meaning}&limit=5000&order=${c.word}.asc`,{
      headers:{
        'apikey':SB_KEY,
        'Authorization':`Bearer ${SB_KEY}`
      }
    });
    
    if(r.ok){
      const d=await r.json();
      const res=[];
      
      d.forEach(i=>{
        const wv=i[c.word];
        const mv=i[c.meaning];
        if(!wv||!mv)return;
        
        if(wv.includes(',')){
          const ws=wv.split(',').map(w=>w.trim());
          const mw=ws.filter(w=>{
            if(pos==='‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª')return w.endsWith(ltr);
            const p=parseInt(pos);
            if(isNaN(p))return false;
            return w.substring(p-1).startsWith(ltr)
          });
          if(mw.length>0){
            res.push({id:i.id,word:wv,meaning:mv,source:tbl,matchedWords:mw})
          }
        }else{
          let m=false;
          if(pos==='‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª'){
            m=wv.endsWith(ltr)
          }else{
            const p=parseInt(pos);
            if(!isNaN(p))m=wv.substring(p-1).startsWith(ltr)
          }
          if(m)res.push({id:i.id,word:wv,meaning:mv,source:tbl})
        }
      });
      return res
    }
    return[]
  }catch(e){
    return[]
  }
};

const doS4=async()=>{
  if(!letterSrch){
    setS4Results([]);
    return
  }
  setS4Loading(true);
  try{
    const[r1,r2,r3,r4,r5]=await Promise.all([
      srchByPos('sinhala_words',letterSrch,letterPos),
      srchByPos('learnX pedia',letterSrch,letterPos),
      srchByPos('helavisithuru',letterSrch,letterPos),
      srchByPos('english_dictionary',letterSrch,letterPos),
      srchByPos('classic_l',letterSrch,letterPos)
    ]);
    const all=[...r1,...r2,...r3,...r4,...r5];
    all.sort((a,b)=>a.word.localeCompare(b.word,'si'));
    setS4Results(all)
  }catch(e){}
  finally{setS4Loading(false)}
};

const srchByCnt=async(tbl,cnt)=>{
  try{
    const c=TBL_COLS[tbl];
    if(!c)return[];
    
    const r=await fetch(`${SB_URL}/rest/v1/${encodeURIComponent(tbl)}?select=id,${c.word},${c.meaning}&limit=5000&order=${c.word}.asc`,{
      headers:{
        'apikey':SB_KEY,
        'Authorization':`Bearer ${SB_KEY}`
      }
    });
    
    if(r.ok){
      const d=await r.json();
      const res=[];
      
      d.forEach(i=>{
        const wv=i[c.word];
        const mv=i[c.meaning];
        if(!wv||!mv)return;
        
        if(wv.includes(',')){
          const ws=wv.split(',').map(w=>w.trim());
          const mw=ws.filter(w=>{
            const isSi=isSinhala(w);
            const wLen=isSi?getGraphemeCount(w):w.length;
            return wLen===cnt
          });
          if(mw.length>0){
            res.push({id:i.id,word:wv,meaning:mv,source:tbl,matchedWords:mw})
          }
        }else{
          const isSi=isSinhala(wv);
          const wLen=isSi?getGraphemeCount(wv):wv.length;
          if(wLen===cnt)res.push({id:i.id,word:wv,meaning:mv,source:tbl})
        }
      });
      return res
    }
    return[]
  }catch(e){
    return[]
  }
};

const doS5=async()=>{
  if(!letterCnt){
    setS5Results([]);
    return
  }
  const cnt=parseInt(letterCnt);
  if(isNaN(cnt)||cnt<1){
    setS5Results([]);
    return
  }
  setS5Loading(true);
  try{
    const[r1,r2,r3,r4,r5]=await Promise.all([
      srchByCnt('sinhala_words',cnt),
      srchByCnt('learnX pedia',cnt),
      srchByCnt('helavisithuru',cnt),
      srchByCnt('english_dictionary',cnt),
      srchByCnt('classic_l',cnt)
    ]);
    const sinhalaResults=[...r1,...r2,...r3,...r5];
    const englishResults=[...r4];
    
    sinhalaResults.sort((a,b)=>a.word.localeCompare(b.word,'si'));
    englishResults.sort((a,b)=>a.word.localeCompare(b.word));
    
    const all=[...sinhalaResults,...englishResults];
    setS5Results(all)
  }catch(e){}
  finally{setS5Loading(false)}
};

useEffect(()=>{
  const t=setTimeout(()=>{
    if(s1Term&&s1Term.length>=2)doS1(s1Term);
    else{
      setS1Results([]);
      setSelectedIdx(-1)
    }
  },300);
  return()=>clearTimeout(t)
},[s1Term]);

useEffect(()=>{
  const t=setTimeout(()=>{
    if(s3Term&&s3Term.length>=2)doS3(s3Term);
    else setS3Results([])
  },300);
  return()=>clearTimeout(t)
},[s3Term]);

useEffect(()=>{
  if(selectedIdx>=0&&resRef.current){
    const el=resRef.current.children[selectedIdx];
    if(el)el.scrollIntoView({behavior:'smooth',block:'center'})
  }
},[selectedIdx]);

const handleTypeSel=t=>{
  setSelType(t.label);
  setShowDD(false);
  doS2(t.search)
};

useEffect(()=>{
  const hco=e=>{
    if(ddRef.current&&!ddRef.current.contains(e.target))setShowDD(false);
    if(posDDRef.current&&!posDDRef.current.contains(e.target))setShowPosDD(false)
  };
  document.addEventListener('mousedown',hco);
  return()=>document.removeEventListener('mousedown',hco)
},[]);

const hlWord=(txt,st)=>{
  if(!st||!txt)return txt;
  if(txt.includes(',')){
    const ws=txt.split(',').map(w=>w.trim());
    return ws.map((w,i)=>{
      const im=w.toLowerCase().startsWith(st.toLowerCase());
      return<span key={i}>{i>0&&', '}<span style={im?{color:'#827717',fontWeight:'bold'}:{}}>{w}</span></span>
    })
  }
  const rx=new RegExp(`(${st})`,'gi');
  const pts=txt.split(rx);
  return pts.map((p,i)=>p.toLowerCase()===st.toLowerCase()?<span key={i}style={{color:'#827717'}}>{p}</span>:<span key={i}>{p}</span>)
};

const extrSents=(cnt,st,mx=3)=>{if(!cnt||!st)return null;const cc=cnt.replace(/<[^>]*>/g,' ').replace(/\s+/g,' ').trim();const ss=cc.split(/[.!?]+/).map(s=>s.trim()).filter(s=>s.length>0);const sl=st.toLowerCase();const rs=ss.filter(s=>s.toLowerCase().includes(sl));return rs.slice(0,mx)};
const HistRes=({item,searchTerm})=>{const rs=extrSents(item.meaning,searchTerm);const hrm=()=>{const cc=item.meaning.replace(/<br\s*\/?>/gi,'\n').replace(/<p>/gi,'\n\n').replace(/<\/p>/gi,'').replace(/<[^>]*>/g,'').replace(/\n{3,}/g,'\n\n').trim();setModalContent({title:item.word,content:cc});setModalOpen(true)};return(<div className="p-3 bg-amber-50 rounded-lg border-l-4 border-amber-600"><div className="flex items-center justify-between mb-2"><div className="flex items-center gap-2"><p className="font-bold text-amber-900 text-lg">{item.word}</p><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className={`favorite-btn ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}><HeartIcon filled={isFav(item)}/></button></div>{rs&&rs.length>0?(<div><ul className="text-sm text-gray-700 space-y-1 mb-3 list-disc list-inside">{rs.map((s,idx)=>(<li key={idx}className="leading-relaxed">{s.length>150?s.substring(0,150)+'...':s}</li>))}</ul><button onClick={hrm}className="inline-flex items-center gap-1 text-amber-700 hover:text-amber-900 hover:underline font-semibold text-sm cursor-pointer"><span>üìñ</span><span>‡∑É‡∂∏‡∑ä‡∂¥‡∑ñ‡∂ª‡∑ä‡∂´ ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫ ‡∂ö‡∑í‡∂∫‡∑Ä‡∂±‡∑ä‡∂±</span><svg className="w-4 h-4"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path strokeLinecap="round"strokeLinejoin="round"strokeWidth={2}d="M9 5l7 7-7 7"/></svg></button></div>):(<div><p className="text-sm text-gray-700 mb-2">{item.meaning.replace(/<[^>]*>/g,' ').replace(/\s+/g,' ').substring(0,200)}...</p><button onClick={hrm}className="inline-flex items-center gap-1 text-amber-700 hover:text-amber-900 hover:underline font-semibold text-sm cursor-pointer"><span>üìñ</span><span>‡∑É‡∂∏‡∑ä‡∂¥‡∑ñ‡∂ª‡∑ä‡∂´ ‡∂Ω‡∑í‡∂¥‡∑í‡∂∫ ‡∂ö‡∑í‡∂∫‡∑Ä‡∂±‡∑ä‡∂±</span></button></div>)}</div>)};
const RegRes=({item,searchTerm})=>{const hlt=(txt,tm)=>{if(!tm||!txt)return txt;const ws=txt.split(/(\s+)/);return ws.map((w,idx)=>{if(w.toLowerCase().includes(tm.toLowerCase())&&w.trim()){return<span key={idx}className="bg-yellow-200 font-bold text-yellow-900"style={{padding:'0 2px',borderRadius:'3px'}}>{w}</span>}return w})};return(<div className="p-3 bg-lime-50 rounded-lg border-l-4 border-lime-600"><div className="flex items-center justify-between mb-1"><div className="flex items-center gap-2"><p className="font-bold text-lime-900">{item.word}</p><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className={`favorite-btn ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}><HeartIcon filled={isFav(item)}/></button></div><p className="text-sm text-gray-700">{hlt(item.meaning,searchTerm)}</p></div>)};

return(<div className="gradient-bg">{notif&&<div className="fixed top-4 right-4 z-50 notification"><div className="bg-yellow-600 text-white px-6 py-3 rounded-xl shadow-2xl flex items-center gap-2"><span className="text-lg">{notif}</span></div></div>}<div className="max-w-7xl mx-auto p-6">{modalOpen&&<div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"onClick={()=>setModalOpen(false)}><div className="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[80vh] flex flex-col"onClick={e=>e.stopPropagation()}><div className="flex items-center justify-between p-6 border-b border-gray-200"><h2 className="text-2xl font-bold text-gray-800">{modalContent.title}</h2><button onClick={()=>setModalOpen(false)}className="text-gray-500 hover:text-gray-700 text-3xl leading-none">√ó</button></div><div className="p-6 overflow-y-auto flex-1"><div className="prose prose-lg max-w-none">{modalContent.content.split('\n').map((p,idx)=>(p.trim()&&<p key={idx}className="mb-4 text-gray-700 leading-relaxed">{p}</p>))}</div></div><div className="p-6 border-t border-gray-200 flex justify-end"><button onClick={()=>setModalOpen(false)}className="px-6 py-3 bg-amber-600 text-white rounded-xl hover:bg-amber-700 font-semibold transition-colors">‡∑Ä‡∑É‡∂±‡∑ä‡∂±</button></div></div></div>}<div className="text-center mb-8 pt-6"><div className="flex justify-center items-center gap-4 mb-3"><h1 className="text-5xl font-bold text-yellow-900">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫</h1><button onClick={toggleDark}className="p-3 bg-white bg-opacity-30 hover:bg-opacity-50 rounded-full transition-all">{darkMode?<SunIcon/>:<MoonIcon/>}</button></div><p className="text-yellow-900 text-lg opacity-90 font-semibold">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä‡∑ö ‡∂Ö‡∂Ω‡∂Ç‡∂ö‡∑è‡∂ª ‡∂∫‡∑ô‡∂Ø‡∑î‡∂∏‡∑ä ‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä</p></div>{wod&&<div className="mb-6 bg-[#B7E28F] rounded-2xl shadow-xl p-6 text-center"><h3 className="text-yellow-900 text-2xl font-bold mb-2">üìñ ‡∂Ö‡∂Ø ‡∂Ø‡∑Ä‡∑É‡∑ö ‡∑Ä‡∂†‡∂±‡∂∫</h3><div className="bg-white bg-opacity-40 backdrop-blur-sm rounded-xl p-4 inline-block"><div className="flex items-center justify-center gap-3"><p className="text-yellow-900 text-3xl font-bold">{wod.word}</p><button onClick={()=>toggleFav(wod)}className={`favorite-btn p-2 ${isFav(wod)?'active':'text-yellow-800'}`}><HeartIcon filled={isFav(wod)}/></button></div><p className="text-yellow-900 text-lg mt-2 font-semibold">{wod.meaning}</p></div></div>}<div className="flex gap-3 mb-6 flex-wrap"><a href="‡∑Ä‡∑í‡∑É‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∑Ñ‡∑ô‡∂Ω‡∂∂‡∑É.html"className="flex-1 min-w-[200px] px-6 py-4 bg-white bg-opacity-30 backdrop-blur-sm border-2 border-yellow-700 border-opacity-40 rounded-t-2xl text-yellow-900 font-bold text-center text-lg hover:bg-opacity-50 transition-all">‡∑Ä‡∑í‡∑É‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∑Ñ‡∑ô‡∑Ö ‡∂∫‡∑ô‡∂Ø‡∑î‡∂∏‡∑ä</a><div className="flex-1 min-w-[200px] px-6 py-4 bg-white rounded-t-2xl font-bold text-center text-lg shadow-lg text-yellow-900 border-b-4 border-lime-500">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫</div><a href="https://amilaeduhelp.github.io/-2025/classic_l.html"target="_blank"rel="noopener noreferrer"className="flex-1 min-w-[200px] px-6 py-4 bg-white bg-opacity-30 backdrop-blur-sm border-2 border-yellow-700 border-opacity-40 rounded-t-2xl text-yellow-900 font-bold text-center text-lg hover:bg-opacity-50 transition-all">‡∑É‡∑è‡∑Ñ‡∑í‡∂≠ ‡∂ö‡∑ô‡∂≠</a><button onClick={()=>setShowFavs(!showFavs)}className="px-6 py-4 bg-red-500 hover:bg-red-600 rounded-t-2xl font-bold text-center text-lg shadow-lg text-white transition-all flex items-center gap-2 min-w-[150px] justify-center"><HeartIcon filled={true}/><span>‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏({favs.length})</span></button></div><div className="bg-white rounded-b-2xl rounded-tr-2xl shadow-2xl overflow-hidden">{showFavs&&<div className="bg-red-50 p-8 border-b-4 border-red-300"><h2 className="text-3xl font-bold text-red-900 mb-6 text-center">‚≠ê ‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏ ‡∑Ä‡∂†‡∂±</h2>{favs.length===0?<p className="text-center text-gray-600 py-8">‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏ ‡∑Ä‡∂†‡∂± ‡∂±‡∑ê‡∂≠. ‚ù§Ô∏è ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂î‡∂∂‡∂±‡∑ä‡∂± ‡∂ë‡∂ö‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!</p>:<div className="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto">{favs.map((item,idx)=>(<div key={idx}className="p-4 bg-white rounded-lg shadow border-l-4 border-red-500"><div className="flex items-center justify-between mb-2"><div className="flex items-center gap-2"><p className="font-bold text-red-900 text-lg">{item.word}</p><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className="favorite-btn active p-2"><HeartIcon filled={true}/></button></div><p className="text-sm text-gray-700">{item.meaning}</p></div>))}</div>}</div>}<div className="bg-[#B7E28F] p-8"><h2 className="text-3xl font-bold text-yellow-900 mb-6 text-center">üîç ‡∑Ä‡∂†‡∂±‡∂∫‡∑ô‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h2><div className="max-w-3xl mx-auto"><input type="text"value={s1Term}onChange={e=>setS1Term(e.target.value)}placeholder="‡∑Ä‡∂†‡∂±‡∂∫‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±..."className="w-full px-6 py-4 text-xl border-4 border-yellow-700 rounded-2xl focus:outline-none focus:ring-4 focus:ring-lime-300"/><p className="text-yellow-900 text-sm mt-2 text-center opacity-90 font-semibold">‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫ ‡∑É‡∑Ñ LearnX Pedia ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑Ä‡∑è</p></div></div>{s1Loading&&<div className="text-center py-12"><div className="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-lime-600"></div></div>}{s1Results.length>0&&<div className="bg-white"><div className="bg-lime-50 border-b-2 border-lime-300 py-3 px-6"><p className="text-center text-lime-900 font-semibold">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω:{s1Results.length}</p></div><div ref={resRef}className="max-h-[500px] overflow-y-auto">{s1Results.map((item,index)=>(<div key={`${item.source}-${item.id}`}className={`p-6 border-b ${index===selectedIdx?'selected-result':'hover:bg-gray-50'}`}><div className="flex items-center justify-between mb-2"><div className="flex items-center gap-2"><h3 className={`text-2xl ${index===selectedIdx?'result-word':'font-semibold text-gray-800'}`}>{index===selectedIdx?hlWord(item.word,s1Term):item.word}</h3><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className={`favorite-btn p-2 ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}title={isFav(item)?'‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏‡∂∫‡∂±‡∑ä‡∂ú‡∑ô‡∂±‡∑ä ‡∂â‡∑Ä‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±':'‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏‡∂∫‡∂±‡∑ä‡∂ß ‡∂ë‡∂ö‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±'}><HeartIcon filled={isFav(item)}/></button></div><p className={`text-lg ${index===selectedIdx?'result-meaning':'text-gray-700'}`}>{index===selectedIdx?hlWord(item.meaning,s1Term):item.meaning}</p></div>))}</div></div>}{!s1Loading&&s1Term.length>=2&&s1Results.length===0&&<div className="text-center py-12 text-gray-600"><p>"{s1Term}" ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω ‡∑Ñ‡∂∏‡∑î ‡∂±‡∑ú‡∑Ä‡∑ì‡∂∫</p></div>}<div className="bg-gray-50 p-8"><h3 className="text-2xl font-bold text-gray-800 mb-6 text-center">‡∑Ä‡∑ô‡∂±‡∂≠‡∑ä ‡∑É‡∑ô‡∑Ä‡∑î‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂Ω‡∑ä‡∂¥</h3><div className="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto"><div className="bg-white rounded-xl shadow-lg p-6 border-t-4 border-lime-600"><h4 className="text-xl font-bold text-lime-900 mb-4">üìö ‡∑Ä‡∂†‡∂± ‡∑Ä‡∂ª‡∑ä‡∂ú ‡∂Ö‡∂±‡∑î‡∑Ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h4><div className="relative"ref={ddRef}><button onClick={()=>setShowDD(!showDD)}className="w-full px-4 py-3 border-2 border-lime-300 rounded-xl focus:outline-none text-left flex items-center justify-between bg-white hover:bg-lime-50"><span>{selType||'‡∑Ä‡∂†‡∂± ‡∑Ä‡∂ª‡∑ä‡∂ú‡∂∫‡∂ö‡∑ä ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±...'}</span><ChevronDownIcon/></button>{showDD&&<div className="absolute z-20 w-full mt-2 bg-white border-2 border-lime-300 rounded-xl shadow-xl max-h-80 overflow-y-auto">{WORD_TYPES.map((type,idx)=>(<button key={idx}onClick={()=>handleTypeSel(type)}className="w-full px-4 py-3 text-left hover:bg-lime-50 border-b border-lime-200 last:border-b-0">{type.label}</button>))}</div>}</div>{s2Loading&&<div className="mt-4 flex justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-lime-600"></div></div>}{s2Results.length>0&&<div className="mt-4"><p className="text-sm text-lime-800 mb-3 font-semibold">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω:{s2Results.length}</p><div className="max-h-96 overflow-y-auto space-y-2">{s2Results.map(item=>(<div key={item.id}className="p-3 bg-lime-50 rounded-lg border-l-4 border-lime-600"><div className="flex items-center justify-between mb-1"><div className="flex items-center gap-2"><p className="font-bold text-lime-900">{item.word}</p></div><button onClick={()=>toggleFav(item)}className={`favorite-btn ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}><HeartIcon filled={isFav(item)}/></button></div><p className="text-sm text-gray-700">{item.meaning}</p></div>))}</div></div>}</div><div className="bg-white rounded-xl shadow-lg p-6 border-t-4 border-amber-600"><h4 className="text-xl font-bold text-amber-900 mb-4">üîé ‡∂ï‡∂±‡∑ë‡∂∏ ‡∂≠‡∑ê‡∂±‡∂ö‡∑í‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h4><input type="text"value={s3Term}onChange={e=>setS3Term(e.target.value)}placeholder="‡∑Ä‡∂†‡∂±‡∂∫‡∂ö‡∑ä ‡∑Ñ‡∑ù ‡∂Ö‡∂ª‡∑ä‡∂Æ‡∂∫‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±..."className="w-full px-4 py-3 border-2 border-amber-300 rounded-xl focus:outline-none focus:border-amber-600"/><p className="text-xs text-gray-600 mt-2">‡∑É‡∑í‡∂∫‡∂Ω‡∑î database ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑Ä‡∑è(English ‡∑É‡∂∏‡∂ü)</p>{s3Loading&&<div className="mt-4 flex justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"></div></div>}{s3Results.length>0&&<div className="mt-4"><p className="text-sm text-amber-800 mb-3 font-semibold">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω:{s3Results.length}</p><div className="max-h-96 overflow-y-auto space-y-2">{s3Results.map((item,idx)=>(item.source==='Historynt'?<HistRes key={`${item.source}-${item.id}-${idx}`}item={item}searchTerm={s3Term}/>:<RegRes key={`${item.source}-${item.id}-${idx}`}item={item}searchTerm={s3Term}/>))}</div></div>}</div><div className="bg-white rounded-xl shadow-lg p-6 border-t-4 border-yellow-600 md:col-span-2"><h4 className="text-xl font-bold text-yellow-900 mb-4">üéØ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫ ‡∂Ö‡∂±‡∑î‡∑Ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h4><div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><div><label className="block text-sm font-semibold text-yellow-900 mb-2">‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫</label><button onClick={()=>setShowPosDD(true)}className="w-full px-4 py-3 border-2 border-yellow-300 rounded-xl focus:outline-none text-left flex items-center justify-between bg-white hover:bg-yellow-50"><span>{letterPos==='‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª'?'‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª':`${letterPos} ‡∑Ä‡∂± ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫`}</span><ChevronDownIcon/></button>{showPosDD&&<div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"onClick={()=>setShowPosDD(false)}><div className="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[70vh] flex flex-col"onClick={e=>e.stopPropagation()}><div className="flex items-center justify-between p-4 border-b border-gray-200"><h3 className="text-lg font-bold text-yellow-900">‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫ ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±</h3><button onClick={()=>setShowPosDD(false)}className="text-gray-500 hover:text-gray-700 text-2xl leading-none">√ó</button></div><div className="overflow-y-auto flex-1"><button onClick={()=>{setLetterPos('‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª');setShowPosDD(false)}}className="w-full px-6 py-4 text-left hover:bg-yellow-50 font-semibold text-yellow-900 border-b border-yellow-200">‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª</button>{[...Array(19)].map((_,i)=>(<button key={i+2}onClick={()=>{setLetterPos((i+2).toString());setShowPosDD(false)}}className="w-full px-6 py-4 text-left hover:bg-yellow-50 border-b border-yellow-200">{i+2} ‡∑Ä‡∂± ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫</button>))}</div></div></div>}</div><div><label className="block text-sm font-semibold text-yellow-900 mb-2">‡∂Ö‡∂ö‡∑î‡∂ª</label><input type="text"value={letterSrch}onChange={e=>setLetterSrch(e.target.value)}placeholder="‡∂ã‡∂Ø‡∑è: ‡∂ö, ‡∂ö‡∑î, ‡∂ö‡∑ô, ‡∂Ω‡∑è..."className="w-full px-4 py-3 border-2 border-yellow-300 rounded-xl focus:outline-none focus:border-yellow-600"/></div></div><button onClick={doS4}disabled={!letterSrch}className="w-full px-6 py-3 bg-yellow-600 text-white rounded-xl hover:bg-yellow-700 font-semibold transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</button><p className="text-xs text-gray-600 mt-2">‡∂ã‡∂Ø‡∑è: ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫=4, ‡∂Ö‡∂ö‡∑î‡∂ª=‡∂ö‡∑î ‚Üí "‡∑Ä‡∑í‡∂Ω‡∂ö‡∑ä‡∂ö‡∑î‡∑Ä", "‡∂≠‡∑î‡∑Ä‡∂ö‡∑ä‡∂ö‡∑î‡∑Ä" | ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫=‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª, ‡∂Ö‡∂ö‡∑î‡∂ª=‡∂Ω ‚Üí "‡∂Ö‡∂Ω", "‡∂∏‡∂Ω", "‡∂ú‡∂Ω"</p>{s4Loading&&<div className="mt-4 flex justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div></div>}{s4Results.length>0&&<div className="mt-4"><p className="text-sm text-yellow-800 mb-3 font-semibold">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω:{s4Results.length}</p><div className="max-h-96 overflow-y-auto space-y-2">{s4Results.map((item,idx)=>(<div key={`${item.source}-${item.id}-${idx}`}className="p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-600"><div className="flex items-center justify-between mb-1"><div className="flex items-center gap-2"><p className="font-bold text-yellow-900">{item.word}</p><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className={`favorite-btn ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}><HeartIcon filled={isFav(item)}/></button></div><p className="text-sm text-gray-700">{item.meaning}</p></div>))}</div></div>}{!s4Loading&&letterSrch&&s4Results.length===0&&letterPos&&<div className="mt-4 text-center text-gray-600 py-4"><p>"{letterSrch}" ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω ‡∑Ñ‡∂∏‡∑î ‡∂±‡∑ú‡∑Ä‡∑ì‡∂∫</p></div>}</div><div className="bg-white rounded-xl shadow-lg p-6 border-t-4 border-lime-600 md:col-span-2"><h4 className="text-xl font-bold text-lime-900 mb-4">üî¢ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂± ‡∂Ö‡∂±‡∑î‡∑Ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h4><div className="mb-4"><label className="block text-sm font-semibold text-lime-900 mb-2">‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂±</label><input type="number"min="1"max="50"value={letterCnt}onChange={e=>setLetterCnt(e.target.value)}placeholder="‡∂ã‡∂Ø‡∑è: 3, 4, 5..."className="w-full px-4 py-3 border-2 border-lime-300 rounded-xl focus:outline-none focus:border-lime-600"/></div><button onClick={doS5}disabled={!letterCnt}className="w-full px-6 py-3 bg-lime-600 text-white rounded-xl hover:bg-lime-700 font-semibold transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</button><p className="text-xs text-gray-600 mt-2">‡∂ã‡∂Ø‡∑è: ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂±=3 ‚Üí "‡∂Ö‡∂∏‡∂ª", "‡∂Ö‡∂ª‡∂´", "‡∂Ø‡∑ô‡∂ª‡∂´", "‡∂¥‡∂ª‡∂´" | ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂±=5 ‚Üí "‡∂Ö‡∂π‡∂ª‡∑î‡∑Ä", "‡∂ö‡∑Ö‡∑î‡∑Ä‡∂ª"</p>{s5Loading&&<div className="mt-4 flex justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-lime-600"></div></div>}{s5Results.length>0&&<div className="mt-4"><p className="text-sm text-lime-800 mb-3 font-semibold">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω:{s5Results.length}</p><div className="max-h-96 overflow-y-auto space-y-2">{s5Results.map((item,idx)=>(<div key={`${item.source}-${item.id}-${idx}`}className="p-3 bg-lime-50 rounded-lg border-l-4 border-lime-600"><div className="flex items-center justify-between mb-1"><div className="flex items-center gap-2"><p className="font-bold text-lime-900">{item.word}</p><TableBadge source={item.source}/></div><button onClick={()=>toggleFav(item)}className={`favorite-btn ${isFav(item)?'active':'text-gray-400 hover:text-red-500'}`}><HeartIcon filled={isFav(item)}/></button></div><p className="text-sm text-gray-700">{item.meaning}</p></div>))}</div></div>}{!s5Loading&&letterCnt&&s5Results.length===0&&<div className="mt-4 text-center text-gray-600 py-4"><p>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂± {letterCnt} ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω ‡∑Ñ‡∂∏‡∑î ‡∂±‡∑ú‡∑Ä‡∑ì‡∂∫</p></div>}</div></div><div className="mb-6 grid grid-cols-2 md:grid-cols-6 gap-3">{Object.entries(TBL_COLORS).map(([table,color])=>(<div key={table}className="bg-white bg-opacity-40 backdrop-blur-sm rounded-xl p-4 text-center border-2 border-yellow-600 border-opacity-30"><div className={`inline-block px-3 py-1 rounded-lg ${color.bg} ${color.text} text-sm font-semibold mb-2`}>{color.label}</div><div className="text-yellow-900 text-2xl font-bold">{wCounts[table]?.toLocaleString()||'...'}</div><div className="text-yellow-900 text-xs opacity-80 font-semibold">‡∑Ä‡∂†‡∂±</div></div>))}</div><div className="mt-8 bg-gradient-to-br from-lime-100 to-yellow-100 rounded-xl p-6"><h3 className="text-lg font-bold text-gray-800 mb-4 text-center">‡∂∑‡∑è‡∑Ä‡∑í‡∂≠ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±‡∑ö ‡∂ö‡∑ô‡∑É‡∑ö‡∂Ø?</h3><div className="grid grid-cols-1 md:grid-cols-5 gap-4 text-sm mb-6"><div className="p-4 bg-white rounded-lg shadow"><h4 className="font-bold text-lime-900 mb-2">üîç ‡∑Ä‡∂†‡∂±‡∂∫‡∑ô‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±</h4><p className="text-gray-700">‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫ ‡∑É‡∑Ñ LearnX Pedia ‡∂∫‡∂± database ‡∂Ø‡∑ô‡∂ö‡∑ô‡∂±‡∑ä‡∂∏ ‡∑Ä‡∂†‡∂±‡∂∫ ‡∂Ö‡∂±‡∑î‡∑Ä ‡∑É‡∑ú‡∂∫‡∂±‡∑Ä‡∑è. ‡∂∏‡∑ê‡∂Ø ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂± ‡∑Ä‡∂†‡∂±‡∂∫ ‡∂¥‡∑ä‚Äç‡∂ª‡∂∞‡∑è‡∂± ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω‡∂∫‡∂∫‡∑í.</p></div><div className="p-4 bg-white rounded-lg shadow"><h4 className="font-bold text-lime-900 mb-2">üìö ‡∑Ä‡∂†‡∂± ‡∑Ä‡∂ª‡∑ä‡∂ú ‡∂Ö‡∂±‡∑î‡∑Ä</h4><p className="text-gray-700">‡∂±‡∑è‡∂∏ ‡∂¥‡∂Ø, ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∂¥‡∂Ø, ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´ ‡∂¥‡∂Ø ‡∑Ä‡∑ê‡∂±‡∑í ‡∑Ä‡∂†‡∂± ‡∑Ä‡∂ª‡∑ä‡∂ú ‡∂Ö‡∂±‡∑î‡∑Ä ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫‡∑ô‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±.</p></div><div className="p-4 bg-white rounded-lg shadow"><h4 className="font-bold text-amber-900 mb-2">üîé ‡∂ï‡∂±‡∑ë‡∂∏ ‡∂≠‡∑ê‡∂±‡∂ö‡∑í‡∂±‡∑ä</h4><p className="text-gray-700">‡∑É‡∑í‡∂∫‡∂Ω‡∑î database 6 ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä‡∂∏(English ‡∑É‡∂∏‡∂ü) ‡∑Ä‡∂†‡∂±‡∂∫‡∑ö ‡∑Ñ‡∑ù ‡∂Ö‡∂ª‡∑ä‡∂Æ‡∂∫‡∑ö ‡∂ï‡∂±‡∑ë‡∂∏ ‡∂≠‡∑ê‡∂±‡∂ö ‡∂á‡∂≠‡∑í ‡∂¥‡∑è‡∂®‡∂∫ ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±.</p></div><div className="p-4 bg-white rounded-lg shadow"><h4 className="font-bold text-yellow-900 mb-2">üéØ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫ ‡∂Ö‡∂±‡∑î‡∑Ä</h4><p className="text-gray-700">‡∑Ä‡∂†‡∂±‡∂∫‡∑ö ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∑í‡∂≠ ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫‡∂ö(‡∂ã‡∂Ø‡∑è: 4 ‡∑Ä‡∂± ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫) ‡∑Ñ‡∑ù ‡∂Ö‡∂ú ‡∂Ö‡∂ö‡∑î‡∂ª ‡∂Ω‡∑ô‡∑É ‡∂∫‡∂∏‡∑ä ‡∂Ö‡∂ö‡∑î‡∂ª‡∂ö‡∑ä ‡∂á‡∂≠‡∑í ‡∑Ä‡∂†‡∂± ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±.</p></div><div className="p-4 bg-white rounded-lg shadow"><h4 className="font-bold text-lime-900 mb-2">üî¢ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂± ‡∂Ö‡∂±‡∑î‡∑Ä</h4><p className="text-gray-700">‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂±‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª ‡∂ë‡∂∏ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ú‡∂´‡∂± ‡∂á‡∂≠‡∑í ‡∑Ä‡∂†‡∂± ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±. ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂ú‡∑è‡∂≠‡∑ä‚Äç‡∂ª‡∑è‡∂ö‡∑ä‡∑Ç‡∂ª ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∑Ä ‡∂ú‡∂´‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è!</p></div></div><div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div className="p-4 bg-gradient-to-r from-red-100 to-pink-100 rounded-lg shadow"><h4 className="font-bold text-red-900 mb-2">‚≠ê ‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏ ‡∑Ä‡∂†‡∂±</h4><p className="text-gray-700">‚ù§Ô∏è ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂î‡∂∂‡∂Ω‡∑è ‡∂î‡∂∂‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏ ‡∑Ä‡∂†‡∂± ‡∑É‡∑î‡∂ª‡∂ö‡∑í‡∂±‡∑ä‡∂±. ‡∂¥‡∑É‡∑î‡∑Ä "‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂≠‡∂∏" tab ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä ‡∂∂‡∂Ω‡∂±‡∑ä‡∂±.</p></div><div className="p-4 bg-gradient-to-r from-yellow-100 to-lime-100 rounded-lg shadow"><h4 className="font-bold text-yellow-900 mb-2">üìñ ‡∂Ö‡∂Ø ‡∂Ø‡∑Ä‡∑É‡∑ö ‡∑Ä‡∂†‡∂±‡∂∫</h4><p className="text-gray-700">‡∂Ø‡∑í‡∂±‡∂¥‡∂≠‡∑è ‡∂±‡∑Ä ‡∑Ä‡∂†‡∂±‡∂∫‡∂ö‡∑ä ‡∂â‡∂ú‡∑ô‡∂± ‡∂ú‡∂±‡∑ä‡∂±. ‡∂î‡∂∂‡∑ö vocabulary ‡∑Ä‡∂ª‡∑ä‡∂∞‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!</p></div><div className="p-4 bg-gradient-to-r from-lime-100 to-yellow-100 rounded-lg shadow"><h4 className="font-bold text-lime-900 mb-2">üåì Dark Mode</h4><p className="text-gray-700">‡∂ª‡∑è‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑ö ‡∂ö‡∑í‡∂∫‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂¥‡∑Ñ‡∑É‡∑î‡∑Ä‡∂ö‡∑ä. ‡∂â‡∑Ñ‡∑Ö ‡∂Ø‡∂ö‡∑î‡∂´‡∑ö üåô ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂î‡∂∂‡∂±‡∑ä‡∂±.</p></div><div className="p-4 bg-gradient-to-r from-yellow-100 to-amber-100 rounded-lg shadow"><h4 className="font-bold text-amber-900 mb-2">üíæ Auto Save</h4><p className="text-gray-700">‡∑É‡∑í‡∂∫‡∂Ω‡∑î settings ‡∑É‡∑Ñ favorites browser ‡∂ë‡∂ö‡∑ö save ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è. Browser ‡∑Ä‡∑Ñ‡∂Ω‡∂≠‡∑ä ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê!</p></div></div></div></div><div className="text-center py-6 bg-gray-100 border-t"><p className="text-gray-600 text-sm">Copyright ¬© Amila Udawattha</p><p className="text-gray-500 text-xs mt-1">‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∑è‡∂Ç‡∂ú ‡∑É‡∑Ñ‡∑í‡∂≠‡∑Ä - v2.2 (Dandelion Tea ‡∑Ä‡∂ª‡∑ä‡∂´ ‡∑É‡∑Ñ‡∑í‡∂≠‡∂∫‡∑í)</p></div></div></div></div>)}
const root=ReactDOM.createRoot(document.getElementById('root'));
root.render(<App/>);
</script>
</body>
</html>
‡∑ä
